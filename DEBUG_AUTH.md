# –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—î—é

## –ü—Ä–æ–±–ª–µ–º–∞: 401 Unauthorized

–Ø–∫—â–æ –≤–∏ –±–∞—á–∏—Ç–µ –ø–æ–º–∏–ª–∫—É `401 Unauthorized` –≤ API –∑–∞–ø–∏—Ç–∞—Ö, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –Ω–µ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –∞–±–æ –Ω–µ –≤–∞–ª—ñ–¥–Ω–∏–π.

## –ö—Ä–æ–∫–∏ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

–í—ñ–¥–∫—Ä–∏–π—Ç–µ Developer Tools (F12) —ñ –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ –ª–æ–≥–∏:

```
üîê Auth state changed: { isAuthenticated: false, hasUser: false, hasAccessToken: false }
‚ùå Authorization header removed
üöÄ API Request: { method: 'GET', url: '/tasks', headers: { Authorization: 'None' } }
‚ùå API Error: { status: 401, message: 'Unauthorized', url: '/tasks' }
```

### 2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ AuthDebug –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

–í –ø—Ä–∞–≤–æ–º—É –Ω–∏–∂–Ω—å–æ–º—É –∫—É—Ç—ñ –ø–æ–≤–∏–Ω–µ–Ω –∑'—è–≤–∏—Ç–∏—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —Å—Ç–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó:

- **Loading**: ‚úÖ (–ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è)
- **Authenticated**: ‚ùå (—è–∫—â–æ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π)
- **Has User**: ‚ùå (—è–∫—â–æ –Ω–µ–º–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞)
- **Has Access Token**: ‚ùå (—è–∫—â–æ –Ω–µ–º–∞—î —Ç–æ–∫–µ–Ω–∞)

### 3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π:
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ `/login`
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–£–≤—ñ–π—Ç–∏" –∞–±–æ "–£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"
3. –ü—Ä–æ–π–¥—ñ—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –≤ Cognito
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø–æ–≤–µ—Ä–Ω—É–≤—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞ –≥–æ–ª–æ–≤–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É

### 4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–æ–∫–µ–Ω

–ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –≤ –∫–æ–Ω—Å–æ–ª—ñ –ø–æ–≤–∏–Ω–Ω–æ –∑'—è–≤–∏—Ç–∏—Å—è:

```
üîê Auth state changed: { isAuthenticated: true, hasUser: true, hasAccessToken: true }
‚úÖ Authorization header set: Bearer eyJhbGciOiJSUzI1NiI...
üöÄ API Request: { method: 'GET', url: '/tasks', headers: { Authorization: 'Bearer [TOKEN]' } }
‚úÖ API Response: { status: 200, url: '/tasks' }
```

## –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π

**–°–∏–º–ø—Ç–æ–º–∏:**
- AuthDebug –ø–æ–∫–∞–∑—É—î `Authenticated: ‚ùå`
- –í –∫–æ–Ω—Å–æ–ª—ñ: `üîí User not authenticated, redirecting to login`

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—Ö–æ–¥—É
2. –£–≤—ñ–π–¥—ñ—Ç—å —á–µ—Ä–µ–∑ Cognito
3. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ redirect URI –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ–º–∞—î —Ç–æ–∫–µ–Ω–∞

**–°–∏–º–ø—Ç–æ–º–∏:**
- `Authenticated: ‚úÖ` –∞–ª–µ `Has Access Token: ‚ùå`
- –í –∫–æ–Ω—Å–æ–ª—ñ: `‚ùå Authorization header removed`

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Cognito User Pool
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ scope –≤–∫–ª—é—á–∞—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π OAuth 2.0 flow

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –¢–æ–∫–µ–Ω –Ω–µ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è

**–°–∏–º–ø—Ç–æ–º–∏:**
- `Has Access Token: ‚úÖ` –∞–ª–µ –≤ API –∑–∞–ø–∏—Ç—ñ `Authorization: 'None'`

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∞—Ü—é—î `setAuthHeaders`
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ `useAuth` —Ö—É–∫ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è
3. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –¢–æ–∫–µ–Ω –Ω–µ –≤–∞–ª—ñ–¥–Ω–∏–π

**–°–∏–º–ø—Ç–æ–º–∏:**
- –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è, –∞–ª–µ API –ø–æ–≤–µ—Ä—Ç–∞—î 401
- –ú–æ–∂–ª–∏–≤–æ, —Ç–æ–∫–µ–Ω –∑–∞—Å—Ç–∞—Ä—ñ–≤

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π API Gateway
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ Cognito User Pool –ø—Ä–∞–≤–∏–ª—å–Ω–æ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∏–π –∑ API
3. –°–ø—Ä–æ–±—É–π—Ç–µ –≤–∏–π—Ç–∏ —Ç–∞ —É–≤—ñ–π—Ç–∏ –∑–Ω–æ–≤—É

## –õ–æ–≥–∏ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –£—Å–ø—ñ—à–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è:
```
üîê Auth state changed: { isAuthenticated: true, hasUser: true, hasAccessToken: true }
‚úÖ Authorization header set: Bearer eyJhbGciOiJSUzI1NiI...
üìä useStudyItems effect: { isAuthenticated: true, isLoading: false, hasAccessToken: true }
üöÄ API Request: { method: 'GET', url: '/tasks', headers: { Authorization: 'Bearer [TOKEN]', x-api-key: '[SET]' } }
‚úÖ API Response: { status: 200, url: '/tasks' }
```

### –ù–µ—É—Å–ø—ñ—à–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è:
```
üîê Auth state changed: { isAuthenticated: false, hasUser: false, hasAccessToken: false }
‚ùå Authorization header removed
üìä useStudyItems effect: { isAuthenticated: false, isLoading: false, hasAccessToken: false }
‚ö†Ô∏è User not authenticated, skipping API call
```

## –®–≤–∏–¥–∫–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

1. **–û—á–∏—Å—Ç—ñ—Ç—å localStorage/sessionStorage**:
   ```javascript
   localStorage.clear();
   sessionStorage.clear();
   ```

2. **–ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É** (Ctrl+F5)

3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Cognito**:
   - Callback URLs
   - OAuth Scopes
   - Authentication Flow

4. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞**:
   - `VITE_COGNITO_AUTHORITY`
   - `VITE_COGNITO_CLIENT_ID`
   - `VITE_COGNITO_REDIRECT_URI`
